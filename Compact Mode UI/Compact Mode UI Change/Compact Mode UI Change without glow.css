/* ============= COMPACT MODE UI ================ */
:root[customizing] {
    /* Revert all compact mode styles when customizing */
    --disable-compact-mode: true !important;
}

:root[zen-compact-mode="true"]:not([customizing]) #titlebar {
    background: transparent !important;
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    transition: background 0.35s ease, backdrop-filter 0.35s ease, box-shadow 0.35s ease !important;
    box-shadow: none !important;
    border: none !important;
    outline: none !important;
    transform: translateX(5px) !important;
}

:root[customizing] {
    /* Revert all compact mode styles when customizing */
    --disable-compact-mode: true !important;
}

:root[zen-compact-mode="true"]:not([customizing]) #titlebar {
    background: transparent !important;
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    transition: background 0.35s ease, backdrop-filter 0.35s ease, box-shadow 0.35s ease !important;
    box-shadow: none !important;
    border: none !important;
    outline: none !important;
    transform: translateX(10px) !important;
}

:root[zen-compact-mode="true"]:not([customizing]) #titlebar {
    background: rgba(0, 0, 0, 0.97) !important;
    backdrop-filter: blur(6px) saturate(100%) !important;
    -webkit-backdrop-filter: blur(6px) saturate(100%) !important;
}

:root[customizing] {
    --disable-compact-mode: true !important;
}

:root[zen-compact-mode="true"]:not([customizing]) .browserContainer {
    --margin-top-fix: 0 !important;
}

/* Create a hover detection zone at the top */
:root[zen-compact-mode="true"]:not([customizing]) #zen-appcontent-navbar-wrapper::before {
    content: '' !important;
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: 12px !important; /* Change trigger area hitbox */
    z-index: 9999 !important;
    pointer-events: auto !important;
}

:root[zen-compact-mode="true"]:not([customizing]) #zen-appcontent-navbar-wrapper {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: 0 !important;
    min-height: 0 !important;
    z-index: 999 !important;
    pointer-events: none !important;
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    overflow: visible !important;
    display: block !important;
}

:root[zen-compact-mode="true"]:not([customizing]) #zen-appcontent-navbar-wrapper:hover {
    pointer-events: auto !important;
}

:root[zen-compact-mode="true"]:not([customizing]) #zen-appcontent-navbar-container {
    position: fixed !important;
    top: -70px !important; /* Hidden above viewport */
    left: 50% !important;
    transform: translateX(-50%) !important;
    width: fit-content !important;
    background: transparent !important;
    z-index: 1000 !important;
    display: flex !important;
    justify-content: center !important;
    pointer-events: auto !important;
    margin: 0 !important;
    padding: 0 !important;
    height: auto !important;
    opacity: 0 !important;
    transition: top 0.3s ease, opacity 0.3s ease !important;
}

/* Show navbar when hovering near top */
:root[zen-compact-mode="true"]:not([customizing]) #zen-appcontent-navbar-wrapper:hover #zen-appcontent-navbar-container {
    top: 15px !important;
    opacity: 1 !important;
}

:root[zen-compact-mode="true"]:not([customizing]) #nav-bar {
    display: flex !important;
    align-items: center !important;
    gap: 0 !important;
    background: rgba(0, 0, 0, 0.97) !important;
    backdrop-filter: blur(6px) saturate(100%) !important;
    -webkit-backdrop-filter: blur(6px) saturate(100%) !important;
    border-radius: 12px !important;
    padding: 1px 3px !important;
    margin: 0 !important;
    width: 35vw !important; /* Change width of floating toolbar */
    height: 50px !important;
    overflow: visible !important;
    transition: box-shadow 0.35s ease, background 0.35s ease !important;
    will-change: box-shadow, background;
}

:root[zen-compact-mode="true"]:not([customizing]) .urlbar-input-container {
    flex: 1 1 auto !important;
    display: flex !important;
    justify-content: center !important;
    margin: 0 !important;
    transition: inherit !important;
}

:root[zen-compact-mode="true"]:not([customizing]) .urlbar-input-container .urlbar-input {
    width: 100% !important;
    text-align: center !important;
}

:root[zen-compact-mode="true"]:not([customizing]) .urlbar-input-container .urlbar-icons {
    position: absolute !important;
    right: 8px !important;
    display: flex !important;
    align-items: center !important;
    gap: 4px !important;
}

:root[zen-compact-mode="true"]:not([customizing]) .urlbar-background {
    transition: inherit !important;
}

@media (-moz-bool-pref: "zen.view.sidebar-expanded") {
    #navigator-toolbox {
    --zen-navigation-toolbar-min-width: 100px !important;
    }
}

@media (-moz-bool-pref: "zen.view.compact.hide-tabbar") {
    :root[zen-compact-mode="true"]:not([customizing]) #navigator-toolbox {
        margin-block: 12.5vh !important;
        height: 75vh !important;
    }
}
